knitr::opts_chunk$set(echo = FALSE, warnings = FALSE)
#Pulling packages needed for initial analysis
install.packages("pacman", repos = "http://cran.us.r-project.org")
library("pacman")
pacman::p_load("haven", "ggplot2", "scales",
"dplyr", "magrittr", "ggthemes")
dataset <- 'https://github.com/EvanLih/PUBPOL599_Right_To_Work/raw/master/Dataset/Cleaned_RTW_Dataset.csv'
dataset <- read.csv(dataset, stringsAsFactors = F)
dataset$Right_to_Work %<>% as.factor
#converting the Right_to_Work column into as a factor, as it is currently being read as a integer.
means <- aggregate(incwage ~ Right_to_Work, dataset, mean)
means$incwage %<>% round(2)
#I use the "suppressMessages" command so that the errors generated by ggplot are not printed out in our markdown file. However, because ggplot does not generate messages, we need to make sure to include the "print" command.
suppressMessages(print(ggplot(dataset, aes(Right_to_Work, incwage, fill = Right_to_Work, show.legend = FALSE), group = Right_to_Work) +
geom_boxplot(outlier.color = "red", outlier.shape = NA) +
scale_y_continuous(breaks = c(10000,30000,50000,70000,100000), labels = dollar) +
ylim(0,150000) +
labs(x = "Right to Work", y = "Income (Dollars)") +
geom_text(data=means, aes(label = incwage, y = incwage + .09)) +
scale_x_discrete(breaks= c(0,1), labels = c("No Right to Work", "Right to Work")) +
scale_fill_manual(values = c("dodgerblue4", "indianred4")) +
labs(title = "Median Income by Right to Work Status") +
theme_stata() +
scale_color_stata()+
theme(plot.subtitle=element_text(size=10, hjust=0.5, color="black")) +
theme(plot.title=element_text(size=19, face="bold", hjust = .5)) +
theme(axis.title.x=element_text(face = "bold", size = 10)) +
theme(axis.title.y = element_text(face = "bold", size = 10)) +
theme(axis.text.y = element_text(angle = 45)) +
theme(legend.title=element_blank()) +
guides(fill=FALSE)))
LinRegwage = lm(incwage ~ Right_to_Work, data = dataset)
summary(LinRegwage)
ggplot(dataset, aes(Right_to_Work, incwage, fill = Right_to_Work), group = Right_to_Work) +
geom_bar(stat = "summary", fun.y = "mean", position = position_dodge(width = 2.0), width = .7) +
labs(x = "Right to Work", y = "Income (dollars)") +
scale_x_discrete(breaks= c(0,1), labels = c("No RTW", "Has RTW")) +
scale_y_continuous(breaks = c(10000,20000,30000,40000,50000,60000), labels = dollar) +
scale_fill_manual(name= "Right to Work Status", labels=c("No Right to Work", "Right to Work"),
values = c("dodgerblue4", "indianred4")) +
facet_grid(. ~ sex) +
labs(title = "Average Income by Sex", subtitle = "Divided by Right to Work/ No Right to Work") +
theme_stata() +
scale_color_stata()+
theme(plot.subtitle=element_text(size=10, hjust=0.5, color="black")) +
theme(plot.title=element_text(size=19, face="bold", hjust = .5)) +
theme(axis.title.x=element_text(face = "bold", size = 10)) +
theme(axis.title.y = element_text(face = "bold", size = 10)) +
theme(axis.text.y = element_text(angle = 45))
incSexMeans <- dataset %>% group_by(sex, Right_to_Work) %>% summarise(mean = mean(incwage))
print(incSexMeans)
incSex <- t.test(incwage~sex, data = dataset)
print(incSex)
testRTW=lm(as.numeric(incwage)~Right_to_Work+age,data=dataset)
summary(testRTW)
knitr::opts_chunk$set(echo = FALSE, warnings = FALSE)
install.packages("pacman", repos = "http://cran.us.r-project.org")
library("pacman")
pacman::p_load("haven", "ggplot2", "scales",
"dplyr", "magrittr", "ggthemes")
